{"title": "The global ransomware attack weaponized software updates", "content": " \nWhen the Wannacry ransomware tore through the UK and Europe in May, there was a certain logic to the heightened scale of damage. Ransomware attacks were nothing new, but this one had a secret weapon, a sophisticated software exploit known as EternalBlue, published by the Shadow Brokers in April and believed to have been developed by the NSA. It was nation-state level weaponry turned against soft, civilian targets, like robbing a small-town bank with an Abrams tank. If you were looking for answers on how it spread so far so fast, you didn\u2019t have to look far.\nNow, just over a month later, a new strain of ransomware has inflicted similar damage with almost none of that firepower. A variant of the Petya family of ransomware, the virus has infected thousands of systems across the world, including massive multi-national corporations like Maersk, Rosneft and Merck, but it\u2019s done so with far less raw material. Petya is still using EternalBlue, but by now many of the target organizations are protected, and that exploit is far less crucial to the ransomware\u2019s spread. Instead, Petya exploits more fundamental vulnerabilities in the way we run networks and, more crucially, deliver patches. They\u2019re not as eye-catching as an NSA exploit, but they\u2019re more powerful, and could leave organizations in a much more difficult position as they try to recover from today\u2019s attacks.\n\n\nSpreads SUPER fast - saw org 5K systems hit in under 10 minutes. Restarts computer with ransom message (MBR).\u2014 Dave Kennedy (ReL1K) (@HackingDave) June 27, 2017\n\n\n\nWhere WannaCry focused on poorly patched systems, Petya seems to have hit hardest among large corporate networks, a pattern that\u2019s partially explained by how the virus spread. Once a single computer on a network was infected, Petya leveraged Windows networking tools like Windows Management Instrumentation (WMI) and PsExec to infect other computers on the same network. \nBoth tools are normally used for remote admin access, but security researcher Lesley Carhart says they\u2019re often used by attackers as a way to spread malware within a compromised network.  \u201cWMI is a super-effective lateral movement method for hackers. It's frequently allowed and built-in, so rarely logged or blocked by security tools,\u201d says Carhart. \u201cPsexec is a bit more depreciated and more monitored but still very effective.\u201d\n\u201cThis started as a group targeting businesses\u201d\nEven networks that had patched against the EternalBlue exploit were sometimes vulnerable to attacks launched from within the network. According to F-Secure\u2019s Sean Sullivan, that\u2019s in keeping with previous Petya attacks, which have historically targeted large companies likely to quickly pay out ransoms. \u201cThis started as a group targeting businesses,\u201d Sullivan says, \u201cand you have them picking up an exploit that\u2019s perfect to nail businesses with.\u201d\nThe more troubling aspect is how Petya got into the computers in the first place. According to research by Talos Intelligence, the ransomware may have spread through a falsified update to a Ukranian accounting system called MeDoc. MeDoc has denied the allegations, but a number of other groups have concurred with Talos\u2019s finding, pointing to what appears to be a forged digital signature in the payload. If that signature was effective, it would have given attackers a clean way into almost any system running the software. \nThat would also explain Petya\u2019s heavy footprint in Ukraine: as many as 60 percent of total infections were in the country, including the country\u2019s central bank and largest airport.\n\u201cIt\u2019s like the holy grail for attackers\u201d\nIt\u2019s not the first time hackers have compromised auto-update systems to deliver malware, although the attack has usually been restricted to nation states. In 2012, the Flame malware compromised the Windows update process to deliver malware to targets in Iran, an operation that many have attributed to the US government. A 2013 attack on South Korean banks and TV stations also spread through compromised internal patching systems.\nNYU security researcher Justin Cappos, who works on securing patching procedures as part of The Update Framework, says those underlying flaws are remarkably common. Organizations often fail to verify updates or leave the underlying keys insufficiently protected. At the same time, compromising software updates is one of the most powerful ways to compromise a system.\n\u201cIt\u2019s like the holy grail for attackers,\u201d says Cappos. \u201cThis piece of software is on every computer, it usually runs with admin access, it makes outgoing connections that tend to be encrypted and it bypasses any firewall you have.\u201d \n\n"}
